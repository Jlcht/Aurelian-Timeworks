# E-Shop Architecture Overview

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT SIDE                              â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              React Frontend (Port 3000)                 â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ User Interface                                       â”‚    â”‚
â”‚  â”‚  â€¢ Firebase Auth Client SDK                             â”‚    â”‚
â”‚  â”‚  â€¢ Makes API calls to backend                           â”‚    â”‚
â”‚  â”‚  â€¢ Sends Bearer tokens for authentication               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â”‚ HTTP Requests                     â”‚
â”‚                              â”‚ (with Bearer token)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SERVER SIDE                              â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Express.js Backend API (Port 4000)              â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚              Middleware Layer                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ CORS (allow React frontend)                    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Body Parser (JSON)                             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Authentication (verify tokens)                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Error Handler                                  â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                      â”‚                                  â”‚    â”‚
â”‚  â”‚                      â–¼                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚              Routes Layer                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ /api/auth (auth.routes.js)                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ /api/products (products.routes.js)             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Input Validation                               â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                      â”‚                                  â”‚    â”‚
â”‚  â”‚                      â–¼                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚            Controllers Layer                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ auth.controller.js (working)                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ products.controller.js (TODO - your task!)     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ Business Logic                                 â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â”‚ Firebase Admin SDK                â”‚
â”‚                              â–¼                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FIREBASE SERVICES                             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Firebase   â”‚  â”‚  Firestore   â”‚  â”‚   Storage    â”‚          â”‚
â”‚  â”‚     Auth     â”‚  â”‚   Database   â”‚  â”‚    (Files)   â”‚          â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚ Port: 9099   â”‚  â”‚ Port: 8080   â”‚  â”‚ Port: 9199   â”‚          â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚          â”‚
â”‚  â”‚ â€¢ Users      â”‚  â”‚ â€¢ users      â”‚  â”‚ â€¢ Images     â”‚          â”‚
â”‚  â”‚ â€¢ Tokens     â”‚  â”‚ â€¢ products   â”‚  â”‚ â€¢ Files      â”‚          â”‚
â”‚  â”‚              â”‚  â”‚ â€¢ orders     â”‚  â”‚              â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Firebase Cloud Functions (Port: 5001)           â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ onUserCreate - Creates user profile on signup        â”‚    â”‚
â”‚  â”‚  â€¢ Triggered automatically by Firebase Auth             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request Flow Example

### Example: Get All Products

```
1. User clicks "View Products" in React app
   â”‚
   â–¼
2. React makes GET request to http://localhost:4000/api/products
   â”‚
   â–¼
3. Express server receives request
   â”‚
   â–¼
4. CORS middleware checks origin (allow localhost:3000)
   â”‚
   â–¼
5. Request reaches /api/products route
   â”‚
   â–¼
6. Route calls getAllProducts() controller
   â”‚
   â–¼
7. Controller queries Firestore: db.collection('products').get()
   â”‚
   â–¼
8. Firestore returns product documents
   â”‚
   â–¼
9. Controller formats response as JSON
   â”‚
   â–¼
10. Express sends response back to React
    â”‚
    â–¼
11. React displays products to user
```

---

## ğŸ” Authentication Flow

### Example: Create Product (Admin Only)

```
1. Admin logs in via React (Firebase Auth)
   â”‚
   â–¼
2. React gets ID token: await user.getIdToken()
   â”‚
   â–¼
3. React makes POST request with token:
   Headers: { Authorization: "Bearer <token>" }
   Body: { name, description, price, stock }
   â”‚
   â–¼
4. Express receives request
   â”‚
   â–¼
5. authenticate() middleware extracts token
   â”‚
   â–¼
6. Firebase Admin SDK verifies token
   â”‚
   â–¼
7. If valid, attach user info to req.user
   â”‚
   â–¼
8. requireAdmin() middleware checks req.user.role
   â”‚
   â–¼
9. If admin, continue to validation
   â”‚
   â–¼
10. express-validator checks input
    â”‚
    â–¼
11. If valid, call createProduct() controller
    â”‚
    â–¼
12. Controller creates product in Firestore
    â”‚
    â–¼
13. Return created product to React
```

---

## ğŸ“ File Structure & Responsibilities

```
server/src/
â”‚
â”œâ”€â”€ index.js                    # Main server file
â”‚   â€¢ Initialize Express app
â”‚   â€¢ Set up middleware
â”‚   â€¢ Register routes
â”‚   â€¢ Start server on port 4000
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ firebase.js            # Firebase Admin SDK
â”‚       â€¢ Initialize Firebase Admin
â”‚       â€¢ Connect to emulators
â”‚       â€¢ Export db, auth instances
â”‚
â”œâ”€â”€ middleware/
â”‚   â”œâ”€â”€ auth.js                # Authentication
â”‚   â”‚   â€¢ authenticate() - Verify Firebase token
â”‚   â”‚   â€¢ requireAdmin() - Check admin role
â”‚   â”‚
â”‚   â””â”€â”€ errorHandler.js        # Error handling
â”‚       â€¢ errorHandler() - Catch all errors
â”‚       â€¢ notFound() - Handle 404s
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.routes.js         # Auth endpoints
â”‚   â”‚   â€¢ GET /api/auth/me
â”‚   â”‚   â€¢ POST /api/auth/register
â”‚   â”‚   â€¢ POST /api/auth/login
â”‚   â”‚
â”‚   â””â”€â”€ products.routes.js     # Product endpoints
â”‚       â€¢ GET /api/products
â”‚       â€¢ GET /api/products/:id
â”‚       â€¢ POST /api/products (admin)
â”‚       â€¢ PUT /api/products/:id (admin)
â”‚       â€¢ DELETE /api/products/:id (admin)
â”‚
â””â”€â”€ controllers/
    â”œâ”€â”€ auth.controller.js     # Auth business logic
    â”‚   â€¢ getCurrentUser() - Get user info
    â”‚
    â””â”€â”€ products.controller.js # Product business logic
        â€¢ getAllProducts() - TODO
        â€¢ getProductById() - TODO
        â€¢ createProduct() - TODO
        â€¢ updateProduct() - TODO
        â€¢ deleteProduct() - TODO
```

---

## ğŸ—„ï¸ Database Schema

### Firestore Collections

```
firestore/
â”‚
â”œâ”€â”€ users/                     # User profiles
â”‚   â””â”€â”€ {userId}/
â”‚       â”œâ”€â”€ userProfile
â”‚       â”‚   â”œâ”€â”€ profileImage: string
â”‚       â”‚   â””â”€â”€ userEmail: string
â”‚       â””â”€â”€ role: string (optional - "admin" or "customer")
â”‚
â””â”€â”€ products/                  # Products (YOU create this!)
    â””â”€â”€ {productId}/
        â”œâ”€â”€ name: string
        â”œâ”€â”€ description: string
        â”œâ”€â”€ price: number
        â”œâ”€â”€ stock: number
        â”œâ”€â”€ category: string (optional)
        â”œâ”€â”€ images: array (optional)
        â”œâ”€â”€ createdAt: timestamp
        â””â”€â”€ updatedAt: timestamp (optional)
```

---

## ğŸ”Œ API Endpoints Map

```
http://localhost:4000/
â”‚
â”œâ”€â”€ /                          # Health check
â”‚   â””â”€â”€ GET - Server status
â”‚
â””â”€â”€ /api/
    â”‚
    â”œâ”€â”€ /auth/                 # Authentication
    â”‚   â”œâ”€â”€ GET /me            # Get current user (requires token)
    â”‚   â”œâ”€â”€ POST /register     # Register (handled by Firebase client)
    â”‚   â””â”€â”€ POST /login        # Login (handled by Firebase client)
    â”‚
    â””â”€â”€ /products/             # Products
        â”œâ”€â”€ GET /              # Get all products
        â”œâ”€â”€ GET /:id           # Get single product
        â”œâ”€â”€ POST /             # Create product (admin + token)
        â”œâ”€â”€ PUT /:id           # Update product (admin + token)
        â””â”€â”€ DELETE /:id        # Delete product (admin + token)
```

---

## ğŸ›¡ï¸ Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Request                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: CORS                                           â”‚
â”‚  â€¢ Only allow requests from localhost:3000               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Authentication Middleware                      â”‚
â”‚  â€¢ Verify Firebase ID token                              â”‚
â”‚  â€¢ Attach user info to request                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: Authorization Middleware                       â”‚
â”‚  â€¢ Check user role (admin/customer)                      â”‚
â”‚  â€¢ Allow or deny based on permissions                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: Input Validation                               â”‚
â”‚  â€¢ Validate request body                                 â”‚
â”‚  â€¢ Check required fields                                 â”‚
â”‚  â€¢ Sanitize input                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 5: Business Logic                                 â”‚
â”‚  â€¢ Execute controller function                           â”‚
â”‚  â€¢ Interact with database                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 6: Error Handling                                 â”‚
â”‚  â€¢ Catch any errors                                      â”‚
â”‚  â€¢ Return formatted error response                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Your Implementation Focus

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         What's Already Done (You can use these!)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Express server setup                                 â”‚
â”‚  âœ… Firebase Admin SDK configured                        â”‚
â”‚  âœ… Authentication middleware                            â”‚
â”‚  âœ… Product routes with validation                       â”‚
â”‚  âœ… Error handling                                       â”‚
â”‚  âœ… CORS configuration                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         What You Need to Implement (Level 1)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â³ getAllProducts() - Fetch from Firestore              â”‚
â”‚  â³ getProductById() - Get single product                â”‚
â”‚  â³ createProduct() - Add to Firestore                   â”‚
â”‚  â³ updateProduct() - Update in Firestore                â”‚
â”‚  â³ deleteProduct() - Remove from Firestore              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

### Creating a Product

```
React Frontend                Express Backend              Firestore
      â”‚                             â”‚                          â”‚
      â”‚  POST /api/products         â”‚                          â”‚
      â”‚  + Bearer token             â”‚                          â”‚
      â”‚  + product data             â”‚                          â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
      â”‚                             â”‚                          â”‚
      â”‚                             â”‚ Verify token             â”‚
      â”‚                             â”‚ Check admin role         â”‚
      â”‚                             â”‚ Validate input           â”‚
      â”‚                             â”‚                          â”‚
      â”‚                             â”‚  db.collection()         â”‚
      â”‚                             â”‚     .add(product)        â”‚
      â”‚                             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                             â”‚                          â”‚
      â”‚                             â”‚    Product created       â”‚
      â”‚                             â”‚    Return ID             â”‚
      â”‚                             â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚                             â”‚                          â”‚
      â”‚  { success: true,           â”‚                          â”‚
      â”‚    data: { id, ... } }      â”‚                          â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
      â”‚                             â”‚                          â”‚
      â–¼                             â–¼                          â–¼
```

---

This architecture ensures:

- âœ… **Separation of Concerns** - Each layer has a specific job
- âœ… **Security** - Multiple layers of protection
- âœ… **Scalability** - Easy to add new features
- âœ… **Maintainability** - Clear structure and organization
- âœ… **Testability** - Each component can be tested independently

**Now you understand the big picture! Start implementing! ğŸš€**
